================================================================================
HobbyCAD Changelog
================================================================================

================================================================================
2026-02-08
================================================================================

Added
-----
- Initial commit: project documentation
- PPA created for Debian/Ubuntu packaging
- Initial release (Phase 0 -- Foundation)
- BREP file open, display, and save
- Qt 6 GUI with OCCT AIS 3D viewport
- Tiered startup: Full Mode, Reduced Mode, Command-Line Mode
- Feature tree panel (placeholder)
- Embedded terminal with command history
- Preferences dialog
- About dialog with OpenGL diagnostics
- Dark mode and custom theme support

================================================================================
2026-02-09
================================================================================

Added
-----
- First working skeleton build
- CAD viewport working with OCCT AIS viewer
- CAD viewport navigation (orbit, pan, zoom)

================================================================================
2026-02-10
================================================================================

Added
-----
- CAD viewport animations (smooth transitions)
- Screenshot to README
- LICENSE file (GPL-3.0-only)
- vcpkg registry baseline for version pinning
- Windows and macOS environment setup scripts
- Repository detection and clone to setup scripts
- Cross-platform version pinning documentation (vcpkg + Homebrew)

Fixed
-----
- Source tarball URLs for vcpkg: replace ~ with . for GitHub Release asset names

================================================================================
2026-02-11
================================================================================

Added
-----
- Cross-platform build infrastructure:
  - Windows: MSYS2/UCRT64 + MSVC/vcpkg dual-toolchain support
  - macOS: Homebrew tap integration
  - vcpkg overlay port for OpenCASCADE with MSVC unsigned char fix
- CI workflows:
  - Windows build (MSYS2/GCC + MSVC/vcpkg jobs)
  - DCO (Signed-off-by) enforcement on PRs
- Debian packaging (changelog, compat, copyright, rules)
- Desktop file (resources/hobbycad.desktop)
- CMakePresets.json for consistent build configuration
- Viewport navigation controls using AIS_Canvas2D overlay system:
  - NavOrbitRing: three per-axis orbit ring arcs with arrow indicators
  - NavHomeButton: house icon for view reset
  - ScaleBarWidget: rewritten from QWidget to AIS_Canvas2D
- AIS_Canvas2D base class for screen-fixed 2D overlays
- libhobbycad core.h header with version/init/shutdown stubs
- Translations file (hobbycad_en.ts) with 93 strings

Changed
-------
- tools/ scripts: PATH-independent operation, --uninstall, shell detection

Fixed
-----
- MSVC overlay port for OpenCASCADE
- Manifest mode for vcpkg
- MSYS2 job configuration

================================================================================
2026-02-12
================================================================================

Added
-----
- ViewCube for quick orientation changes
- Orbit rings (AIS_Canvas2D) for constrained rotation
- Scale bar with unit display
- Home button to reset view
- Bindings dialog for customizing keyboard/mouse shortcuts:
  - Accessible from Preferences > Bindings
  - Support for up to 3 bindings per action
  - Expandable tree showing actions with current bindings
  - Real-time binding editor with modifier checkboxes
  - Conflict detection for duplicate bindings
  - Bindings persist to QSettings and apply immediately
- Edit menu with Cut/Copy/Paste/Delete/Select All
- Properties panel (right-side dock)
- Viewport toolbar with icon-above-label buttons and dropdowns
- View > Workspace submenu (Design, Render, Animation, Simulation)
- macOS CI workflow
- Linux CI workflow

Changed
-------
- Reconciled setup scripts across platforms

Fixed
-----
- Windows CI: OpenCASCADE include path in vcpkg overlay port
- Windows CI: MSYS2 build script error handling

================================================================================
2026-02-13
================================================================================

Added
-----
- Shell --help and --version flags (no GUI initialization required)
- Platform-specific flag aliases:
  - Linux/macOS: -h, --help, --version
  - Windows: /h, /?, /help, /version (in addition to Unix-style)
- Shell subcommands for non-interactive use:
  - `hobbycad convert <in> <out>` - Convert between file formats
  - `hobbycad script <file>` - Execute script file
  - Each subcommand has its own --help
- Script --dry-run option for syntax validation without execution
- Script stdin piping: `cat file | hobbycad script -`
- Interactive CLI `convert` command (same features as shell subcommand)
- Interactive CLI `script` command with --dry-run support
- GUI project loading: features, sketches, parameters now populate when
  opening .hcad projects (feature tree, timeline, parameter table)
- CLI `select <type> <name>` command for selecting objects
- Custom AIS grid (replaces V3d_Viewer grid) for proper FitAll behavior
- ViewCube improvements:
  - Smooth animated transitions when clicking faces/edges/corners
  - Orbit-based rotation keeps center point fixed in viewport
  - Panning updates orbit center for subsequent rotations
  - Home button animates back to isometric view
  - Proper text orientation on all faces (including Bottom)
- View > Z-Up Orientation toggle (View menu, default on)
  - Z-up: standard CAD/engineering convention
  - Y-up: game engine/3D graphics convention
- View > Orbit Selected Object toggle (View menu, default off)
  - When enabled, ViewCube rotates around selected object's center
  - When disabled, rotates around current pan position
  - Animated transition when toggling the option
- Axis trihedron and grid excluded from FitAll bounding box calculations
- Preferences dialog: Z-Up Orientation and Orbit Selected Object settings
  - Settings persist across sessions
  - Preferences > General page with Coordinate System and Orbit Behavior groups
- Bindings dialog: Show Grid, Snap to Grid, Z-Up, Orbit Selected actions
- GUI reference documentation (docs/gui_reference.txt)
- CLI `create sketch [name]` command for creating sketches
- Context-aware CLI prompt shows sketch name (e.g., "Sketch Sketch1>")
- Tab completion with contextual argument hints
- Press ? at end of line as alternative to Tab for hints
- CLI commands reference documentation (docs/cli_commands.txt)
- Sketch geometry commands with natural English syntax:
  - `point [at] <x>,<y>`
  - `line [from] <x1>,<y1> to <x2>,<y2>`
  - `circle [at] <x>,<y> radius|diameter <value>`
  - `rectangle [from] <x1>,<y1> to <x2>,<y2>`
  - `arc [at] <x>,<y> radius <r> [angle] <start> to <end>`
- Optional keywords in sketch commands (both forms work for scripting)
- Expression support in numeric values using parentheses
- Parameter name completion in numeric fields
- Parameter validation in CLI and GUI:
  - Names must start with letter or underscore
  - Reserved words (sin, cos, tan, sqrt, pi, etc.) rejected
- Parameters dialog: invalid names turn field red, disable OK/Apply
- Auto-prefix underscore for parameter names starting with digit on load
- This changelog (docs/changelog.txt)
- CLI viewport control commands (full mode only):
  - `zoom <percent>` - Set zoom level (e.g., zoom 200 for 2x)
  - `zoom home` - Reset zoom to fit all objects
  - `panto <x>,<y>,<z>` - Pan camera to center on coordinates
  - `panto home` - Pan to origin (0,0,0)
  - `rotate on <axis> <degrees>` - Rotate view around axis
  - `rotate home` - Reset to isometric view
- CLI viewport command warnings:
  - Sketch Mode: "3D viewport commands are not available in Sketch Mode"
  - Reduced Mode: "No 3D viewport available. 3D viewport commands only work in Full Mode"
  - Pure CLI mode: Commands silently ignored (no GUI context)
- Orbit ring arrow direction correction:
  - Arrows automatically flip based on camera orientation
  - Ensures visual rotation direction matches actual rotation from any view angle
  - Applies to X, Y, and Z axis orbit rings
- Sketch plane selection dialog:
  - Shown when clicking "Create Sketch" button
  - Select sketch plane orientation: XY, XZ, YZ, or custom angled plane
  - Custom angled planes: rotate XY plane around X, Y, or Z axis by any angle
  - Set offset distance from origin along the plane's normal axis
  - Preview text shows resulting plane equation (e.g., "Sketch on XY plane at Z = 10")
  - Angled plane preview shows rotation (e.g., "Sketch on plane rotated 45째 around X axis")
  - Offset is applied when generating 3D wireframe of completed sketch
  - All plane parameters saved with project files
- Sketch plane visualization in 3D viewport:
  - Semi-transparent blue rectangle shows plane orientation and position
  - Center crosshair marks the plane origin
  - Plane is displayed when a sketch is selected in timeline
  - Supports offset planes and custom angled planes
  - Automatically hidden when another feature is selected

Changed
-------
- Sketch arc command uses `angle` keyword instead of `from`

Fixed
-----
- Windows MSVC CI: OpenCASCADE include path calculation (port-version 4)

================================================================================
2026-02-14
================================================================================

Added
-----
- 2D sketch canvas view rotation controls:
  - Q: Rotate canvas counter-clockwise (90째)
  - E: Rotate canvas clockwise (90째)
  - Ctrl+0: Reset canvas rotation to 0째
  - Instant rotation (no animation, QPainter-based)
  - Useful for sketch orientation in lofts with twist
- Context-aware keyboard bindings system:
  - Global context: active in all modes (command search)
  - Always-active contexts: file, edit, view, navigation, viewport
  - Mode-specific contexts: sketch vs design (mutually exclusive)
  - Intelligent conflict detection based on context
  - Same key can have different meanings in different contexts
  - Example: E = "Rotate Canvas CW" (sketch), "Extrude" (design)
- Reserved keyboard shortcuts for future features (Fusion 360 compatible):
  - Sketch tools: S (Select), L (Line), R (Rectangle), C (Circle),
    A (Arc), P (Point), D (Dimension), X (Construction), O (Offset),
    T (Trim), G (Toggle Grid)
  - Design tools: E (Extrude), M (Move), F (Fillet), H (Hole),
    J (Joint), I (Measure), V (Toggle Visibility)
  - Global: / (Command Search)
- Construction planes as first-class objects:
  - Three types: OffsetFromOrigin, OffsetFromPlane, Angled
  - Roll angle for sketch orientation around plane normal
  - Custom origin point in absolute 3D coordinates
  - Properties panel integration when plane selected
  - JSON serialization in project files
  - Construction Plane dialog for creating/editing planes
  - Construct menu in menu bar
- SketchCanvas configurable key bindings:
  - Bindings loaded from settings on startup
  - Automatic reload when preferences change
  - Integration with FullModeWindow and ReducedModeWindow
- Updated GUI reference documentation with keyboard shortcuts

Changed
-------
- 2D viewport rotation shortcuts from `[`/`]` to `Q`/`E`
  (Space Engineers style, left-hand ergonomic)
- Bindings dialog conflict messages now explain context conflicts
- Text entities now support font properties (family, size, bold, italic, rotation)
- Refactored GUI to use library functions, reducing sketchcanvas.cpp by ~735 lines:
  - findAllIntersections() now uses sketch::findAllIntersections()
  - trimEntityAt() now uses sketch::trimEntity()
  - splitEntityAt() and splitEntityAtIntersections() use library functions
  - offsetEntity() now uses sketch::offsetEntity()
  - findClosestPointOnEntity() now uses Entity::closestPoint()
  - Removed ~166 lines of dead code (unused profile detection helpers)
- Build script supports shared library linkage (./build-dev.sh shared)
  - Release shared: 1.9 MB executable + 950 KB library
  - Release static: 2.3 MB executable (default)

Added
-----
- Text parsing module (sketch/parsing.h): coordinate and expression parsing
- Intersection conversion helpers in sketchutils.h
- TKOffset to OpenCASCADE library dependencies (required for shared builds)

